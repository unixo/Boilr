{% set secondaryMenu = 'Anagrafica' %}
{% extends 'BoilrBundle:Default:template5.html.twig' %}
{% form_theme form 'BoilrBundle:Form:fields.html.twig' %}

{% block central_block %}
<h2>Dettagli impianto</h2>

<form id="form_system" action="{{ app.request.requestUri }}" method="post" {{ form_enctype(form) }} >

    {% include 'BoilrBundle:Person:_anag.html.twig' with {'person': person, 'allFields': false} %}

    <fieldset>
        <legend>Dettagli impianto</legend>

        <div><label>Tipo:</label>{{ form_widget(form.systemType) }}</div>
        <div><label>Modello:</label>{{ form_widget(form.product) }}</div>
        <div><label>Collocazione:</label>{{ form_widget(form.address) }}</div>
        <div><label>Data installazione:</label>{{ form_widget(form.installDate, {'attr': {'class': 'jdate'}}) }}</div>
        <div><label>Ultima manutenz.:</label>{{ form_widget(form.lastManteinance, {'attr': {'class': 'jdate'}}) }}</div>
        <div><label>Seriale:</label>{{ form_widget(form.code) }}</div>
        <div><label>Descrizione:</label>{{ form_widget(form.descr) }}</div>
    </fieldset>

    <div style="background-color: white; opacity: 1; width: 100%; padding: 10px;">
        <a href="{{ url('show_person', {'id': person.id}) }}">Torna al dettaglio</a>
        <input id="btnSubmit" type="submit" value="Salva" />
    </div>

    {{ form_rest(form) }}
    {{ form_errors(form) }}
</form>

<div id="dlgWarn" style="display: none" title="Attenzione">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
        Non Ã¨ stato associato l'impianto ad alcun indirizzo. Proseguire ugualmente?
    </p>
</div>
{% endblock %}


{% block javascripts %}
<script type="text/javascript">
    /* <![CDATA[ */

    $(function() {
        $('#dlgWarn').dialog({
            resizable: false,
            width    : 460,
            modal    : true,
            autoOpen : false,
            buttons  : {
                "Annulla": function() { $(this).dialog("close"); },
                "Procedi": function() { $('#form_system').submit(); }
            },
        });

        $('#btnSubmit').click(function(e) {
                if ($('#systemForm_address').val() == "") {
                    $('#dlgWarn').dialog('open');
                    e.preventDefault();
                }
            });
    });

    /* ]]> */
</script>
{% endblock %}
